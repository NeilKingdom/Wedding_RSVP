@model Wedding_RSVP.Models.ViewModels.UserGiftViewModel
@{
   ViewData["Title"] = "Gift Registry";
}

<div class="registry">
   <h1>Gift Registry</h1>
   <h6>See the <a href="~/Home/Index/#faq"><u>FAQ</u></a> for more information on the gift registry</h6>
   <br />
   @if (Model.Gifts != null && Model.Gifts.Count() > 0)
   {
      <table class="table table-gift">
         <thead>
            <tr>
               <td>@Html.DisplayNameFor(model => model.Gifts.FirstOrDefault().ImgUrl)</td>
               <td>Link</td>
               <td>@Html.DisplayNameFor(model => model.Gifts.FirstOrDefault().EstPrice)</td>
               <td>@Html.DisplayNameFor(model => model.Gifts.FirstOrDefault().Desc)</td>
               <td>Select Item</td>
            </tr>
         </thead>
         <tbody>
            @foreach (var gift in Model.Gifts)
            {
               if (gift.Available)
               {
                  <tr class="table-rows">
                     @{ string imageSrc = Url.Content(gift.ImgUrl); }
                     <td><img class="thumbnail" src="@imageSrc" width=180 height=100 /></td>
                     <td><a href="@gift.SiteUrl">Go to Website</a></td>
                     <td>@string.Format("${0:0.00}", gift.EstPrice)</td>
                     <td>@gift.Desc</td>
                     <td><input name="sel-item" class="sel-item" type="checkbox" /></td>
                  </tr>
               }
            }
         </tbody>
      </table>
   }
   else
   {
      <h5>No Gifts have been added to the registry</h5>
   }
</div>

@section Scripts {
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script>
      $(document).ready(function() {
         var $radioButtons = $(".sel-item");

         // Call this when the number of checked boxes is 0, otherwise all items will appear disabled
         function clearDisabled() {
            $radioButtons.each(function() {
               // Remove disabled classes
               $(this).closest(".table-rows").removeClass("table-secondary text-muted");
               $(this).parent().siblings().children(".thumbnail").removeClass("img-opaque");
            });
         }

         $radioButtons.click(function() {
            var numChecked = 0;

            $radioButtons.each(function() {
               // If checkbox is checked, increment count
               if (this.checked)
               {
                  numChecked++;
               }
               // Alter CSS of non-checked elements to make them appear disabled
               $(this).closest(".table-rows").toggleClass("table-secondary text-muted", !this.checked);
               $(this).parent().siblings().children(".thumbnail").toggleClass("img-opaque", !this.checked);
            });

            if (numChecked == 0)
            {
               clearDisabled();
            }
         });
      });
	</script>
}
